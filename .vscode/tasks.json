{
  "version": "2.0.0",
  "options": {
    "cwd": "${workspaceFolder}/api",
    "env": {
      "FB_APP_ID": "top-dash-dev",
      "CORS_DOMAIN": "http://localhost:8080/",
      "USE_EMULATOR": "true",
      "ENCRYPTION_KEY": "X9YTchZdcnyZTNBSBgzj29p7RMBAIubD",
      "ENCRYPTION_IV": "FxC21ctRg9SgiXuZ"
    }
  },
  "tasks": [
    {
      "label": "api",
      "command": "dart_frog dev",
      "type": "shell",
      "isBackground": true,
      "presentation": {
        "close": true,
      },
      "problemMatcher": {
          "owner": "dart",
          "fileLocation": ["relative", "${workspaceFolder}/api"],
          "pattern": {
              "regexp": ".",
              "file": 1,
              "line": 2,
              "column": 3,
          },
          "background": {
              "activeOnStart": true,
              "beginsPattern": {
                  "regexp": "."
              },
              "endsPattern": {
                  "regexp": "^\\[hotreload\\] (\\d{2}:\\d{2}:\\d{2} - Application reloaded\\.|Hot reload is enabled\\.)$"
              }
          }
      },
    },
    {
      "label": "firebase",
      "command": "firebase emulators:start",
      "type": "shell",
      "isBackground": true,
      "presentation": {
        "close": true,
      },
      "problemMatcher": [
        {
          "pattern": [
            {
              "regexp": ".",
              "file": 1,
              "location": 2,
              "message": 3
            }
          ],
          "background": {
            "activeOnStart": true,
            "beginsPattern": ".",
            "endsPattern": ".",
          },
        }
      ],
    },
    {
      "label": "emulate",
      "dependsOn": [
        "firebase",
        "api",
      ],
    },
    {
      "label": "stop emulate",
      "type": "shell",
      "command": "pkill -f \"sh $HOME/.pub-cache/bin/dart_frog dev\" && pkill -f \"firebase emulators:start\"",
      "presentation": {
          "reveal": "silent",
          "panel": "dedicated",
          "close": true,
      }
    }
  ]
}
